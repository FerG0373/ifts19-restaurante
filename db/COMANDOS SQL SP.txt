DELIMITER //

CREATE PROCEDURE sp_personal_select_by_id(
    IN personal_id INT
)
BEGIN
    SELECT 
        id, 
        dni, 
        nombre, 
        apellido, 
        fecha_nacimiento, 
        email, 
        telefono, 
        sexo, 
        puesto, 
        fecha_contratacion,
        activo
    FROM 
        personal
    WHERE 
        id = personal_id;
END //

DELIMITER ;


CREATE PROCEDURE sp_personal_select_all()
BEGIN
    SELECT 
        p.id,
        p.dni,
        p.nombre,
        p.apellido,
        p.fecha_nacimiento,
        p.email,
        p.telefono,
        p.sexo,
        p.puesto,
        p.fecha_contratacion,
        
        u.id 'idUsuario',
        u.pass_hash,
        u.perfil_acceso,
        u.activo
    FROM
        personal p
	INNER JOIN
    usuario u
	ON
    p.id = u.id;
END //

DELIMITER ;


DELIMITER //

CREATE PROCEDURE sp_personal_existe_dni(
    IN personal_dni VARCHAR(20)
)
BEGIN
    SELECT 
        1 
    FROM 
        personal
    WHERE 
        dni = personal_dni
    LIMIT 1; -- Detiene la búsqueda después de la primera coincidencia
END //

DELIMITER ;


DELIMITER //

CREATE PROCEDURE sp_personal_existe_email(
    IN personal_email VARCHAR(100)
)
BEGIN
    SELECT 
        1 
    FROM 
        personal
    WHERE 
        email = personal_email
    LIMIT 1;
END //

DELIMITER ;